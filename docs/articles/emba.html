<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>emba • emba</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="emba">
<meta property="og:description" content="emba">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">emba</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/emba.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bblodfon/emba/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="emba_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>emba</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bblodfon/emba/blob/master/vignettes/emba.Rmd"><code>vignettes/emba.Rmd</code></a></small>
      <div class="hidden name"><code>emba.Rmd</code></div>

    </div>

    
    
<div id="intro" class="section level1">
<h1 class="hasAnchor">
<a href="#intro" class="anchor"></a>Intro</h1>
<p>The <em>emba</em> R package name stands for <em>Ensemble (Boolean) Model Biomarker Analysis</em>. It’s main purpose is to be used on a dataset consisted of an <strong>ensemble of boolean models</strong>. These models are usually (but not necessarily) different versions of the same initial model, parameterized in different ways (e.g. some boolean operators in the models equations have changed from <em>OR</em> to <em>AND</em> or vice-versa). A prerequisite for using this package, is that this model dataset must be tested in-silico against a list of drug combinations, in order to assess which drugs combinations behave <em>synergistically</em> for which models. An example software that generates such boolean model ensembles and performs a comprehensive drug response analysis on them is the DrugLogics NTNU software pipeline (see respective <a href="https://druglogics.github.io/druglogics-doc/">documentation</a>).</p>
<p>Given a list of <em>gold-standard</em> (lab-observed/verified) <strong>synergies</strong> <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, this package enables the easy grouping of the models into different classes based on a specific performance metric evaluation. This model classification enables the discovery and visualization of <strong>biomarkers</strong> - nodes whose <em>activity</em> and/or boolean model <em>parameterization</em> might affect either the prediction performance of those models or the manifestation of the predicted synergies.</p>
<p>In the next sections we will describe the main inputs and outputs of the <em>general analysis</em> functions (which group a lot of functionality into one) and provide some insights on the implementation behind. Biomarkers will be assessed and visualized using a test dataset generated from the DrugLogics software mentioned above. For further analyses using this package on boolean model ensemble datasets see this <a href="https://github.com/bblodfon/gitsbe-model-analysis/">GitHub repository</a>. See also <a href="https://bblodfon.github.io/gitsbe-model-analysis/atopo/cell-lines-2500/">an example</a> that demonstrates all the intermediate steps included in the <em>general analysis</em> functions.</p>
</div>
<div id="setup" class="section level1">
<h1 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h1>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="co"># libraries</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">emba</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">usefun</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">knitr</span>)

<span class="co"># function to plot without output `TRUE`</span>
<span class="no">pr</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span>(<span class="no">x</span>)</pre></body></html></div>
</div>
<div id="input" class="section level1">
<h1 class="hasAnchor">
<a href="#input" class="anchor"></a>Input</h1>
<div id="test-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#test-dataset" class="anchor"></a>Test dataset</h2>
<p>The test dataset we will use has <span class="math inline">\(7500\)</span> boolean models with <span class="math inline">\(139\)</span> nodes each. It helps to think of each model as a <strong>network of nodes</strong> where the edges represent either activation or inhibition of the corresponding target and the nodes activity can be either active (1) or inactive (0).</p>
<p>The models have been assessed for synergy against a total of <span class="math inline">\(153\)</span> drug combinations.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">data_file</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span>()
<span class="kw pkg">utils</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span>(<span class="kw">url</span> <span class="kw">=</span> <span class="st">"https://github.com/bblodfon/emba/blob/master/vignettes/data.rds?raw=true"</span>, <span class="kw">destfile</span> <span class="kw">=</span> <span class="no">data_file</span>)
<span class="no">data.list</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="kw">file</span> <span class="kw">=</span> <span class="no">data_file</span>)

<span class="no">model.predictions</span> <span class="kw">=</span> <span class="no">data.list</span>$<span class="no">model.predictions</span>
<span class="no">models.stable.state</span> <span class="kw">=</span> <span class="no">data.list</span>$<span class="no">models.stable.state</span>
<span class="no">models.link.operator</span> <span class="kw">=</span> <span class="no">data.list</span>$<span class="no">models.equations</span>
<span class="no">observed.synergies</span> <span class="kw">=</span> <span class="no">data.list</span>$<span class="no">observed.synergies</span>

<span class="co"># (x,y) coordinates for visualization</span>
<span class="no">nice.layout</span> <span class="kw">=</span> <span class="no">data.list</span>$<span class="no">nice.layout</span>
<span class="co"># model network as an igraph object</span>
<span class="no">net</span> <span class="kw">=</span> <span class="no">data.list</span>$<span class="no">net</span>

<span class="co"># drug combinations</span>
<span class="no">drug.combos</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">model.predictions</span>)

<span class="co"># change model names (shorter names for readability)</span>
<span class="no">model.names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"model"</span>, <span class="fl">1</span>:<span class="fl">7500</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">model.predictions</span>) <span class="kw">=</span> <span class="no">model.names</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">models.stable.state</span>) <span class="kw">=</span> <span class="no">model.names</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">models.link.operator</span>) <span class="kw">=</span> <span class="no">model.names</span></pre></body></html></div>
</div>
<div id="model-predictions" class="section level2">
<h2 class="hasAnchor">
<a href="#model-predictions" class="anchor"></a>Model Predictions</h2>
<p>This data represents the results of <strong>in-silico testing the models ensemble against a drug combination dataset</strong>. More specifically, the model predictions is a <code>data.frame</code> whose values (corresponding to a specific <strong>model-drug combination element</strong>) can be one of the following:</p>
<ul>
<li>0 (no synergy predicted)</li>
<li>1 (synergy was predicted)</li>
<li>
<code>NA</code> (in case the model couldn’t be assessed for synergy, e.g. there were no stable states in either the drug combination perturbed model or in any of the two single-drug perturbed models).</li>
</ul>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">model.predictions</span>[<span class="fl">1</span>:<span class="fl">5</span>, <span class="fl">77</span>:<span class="fl">84</span>] <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw">caption</span> <span class="kw">=</span> <span class="st">"Model predictions example"</span>)</pre></body></html></div>
<table class="table">
<caption>Model predictions example</caption>
<thead><tr class="header">
<th></th>
<th align="right">PI-JN</th>
<th align="right">PI-D1</th>
<th align="right">PI-60</th>
<th align="right">PI-SB</th>
<th align="right">PI-RU</th>
<th align="right">PI-D4</th>
<th align="right">PI-F4</th>
<th align="right">PI-ST</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>model1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td>model2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td>model3</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td>model4</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td>model5</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="model-stable-states" class="section level2">
<h2 class="hasAnchor">
<a href="#model-stable-states" class="anchor"></a>Model stable states</h2>
<p>Each model must have a <em>stable state configuration</em> where the nodes have fixed to either 0 (inactive state) or 1 (active state). In other words, a <strong>fixpoint attractor</strong>. Of course, if a model has multiple attractors or other methods are used to derive a solution to the system of boolean equations that is the model itself, then continuous activity state values (in the <span class="math inline">\([0,1]\)</span> interval) are also supported.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">models.stable.state</span>[<span class="fl">1</span>:<span class="fl">5</span>, <span class="fl">5</span>:<span class="fl">11</span>] <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw">caption</span> <span class="kw">=</span> <span class="st">"Model stable states example"</span>)</pre></body></html></div>
<table class="table">
<caption>Model stable states example</caption>
<thead><tr class="header">
<th></th>
<th align="right">MAP3K4</th>
<th align="right">MAP2K4</th>
<th align="right">IKBKG</th>
<th align="right">IKBKB</th>
<th align="right">AKT1</th>
<th align="right">BRAF</th>
<th align="right">SMAD3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>model1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>model2</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>model3</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>model4</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>model5</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<div id="model-link-operators" class="section level2">
<h2 class="hasAnchor">
<a href="#model-link-operators" class="anchor"></a>Model link operators</h2>
<p>This is a non-essential input for the functions we will use, but we include it here since the test dataset supports it. It is a way to represent the <strong>structure (parameterization)</strong> of the boolean models in the dataset.</p>
<p>If each boolean model is a list of boolean equations of the form:</p>
<p><code>T = (A1 OR A2 OR ...) AND NOT (I1 OR I2 OR ...)</code></p>
<p>, where the <code>A</code> and <code>I</code> nodes are the activating and inhibiting regulators respectively of the target node <code>T</code> and the <code>AND NOT</code> is the <strong>link (balance) operator</strong>, we can specify a link operator <code>data.frame</code> object whose values (corresponding to a specific <strong>model-node element</strong>) can be one of the following:</p>
<ul>
<li>0 (<code>AND NOT</code> link operator)</li>
<li>1 (<code>OR NOT</code> link operator)</li>
<li>0.5 (if the node is not targeted by <em>both</em> activating and inhibiting regulators and thus the corresponding boolean equation has <strong>no link operator</strong>)</li>
</ul>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">models.link.operator</span>[<span class="fl">1</span>:<span class="fl">5</span>, <span class="fl">1</span>:<span class="fl">10</span>] <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw">caption</span> <span class="kw">=</span> <span class="st">"Models link operator example"</span>)</pre></body></html></div>
<table class="table">
<caption>Models link operator example</caption>
<thead><tr class="header">
<th></th>
<th align="right">MAP3K4</th>
<th align="right">MAP2K4</th>
<th align="right">IKBKB</th>
<th align="right">AKT1</th>
<th align="right">SMAD3</th>
<th align="right">GSK3B</th>
<th align="right">RAF1</th>
<th align="right">GAB2</th>
<th align="right">CTNNB1</th>
<th align="right">NR3C1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>model1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>model2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>model3</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>model4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>model5</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>Note that in the test dataset, the nodes (columns of the <code>models.link.operator</code> object) who didn’t have a link operator are pruned.</p>
</div>
<div id="observed-synergies" class="section level2">
<h2 class="hasAnchor">
<a href="#observed-synergies" class="anchor"></a>Observed synergies</h2>
<p>A list of <em>gold standard</em> drug combinations which have been termed as <strong>synergistic</strong> via experimental and/or other computational methods. These drug combinations must be a subset of the ones tested in the models (the column names of the <code>model.predictions</code> data).</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="kw pkg">usefun</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/usefun/man/pretty_print_vector_values.html">pretty_print_vector_values</a></span>(<span class="no">observed.synergies</span>, <span class="kw">vector.values.str</span> <span class="kw">=</span> <span class="st">"observed synergies"</span>)</pre></body></html></div>
<blockquote>
<p>17 observed synergies: AK-60, AK-BI, AK-D1, PI-D1, PD-G2, AK-G4, D1-G4, PI-JN, BI-P5, PD-P5, PI-P5, AK-PD, BI-PD, AK-PI, BI-PI, PD-PI, PK-ST</p>
</blockquote>
</div>
</div>
<div id="performance-biomarkers" class="section level1">
<h1 class="hasAnchor">
<a href="#performance-biomarkers" class="anchor"></a>Performance biomarkers</h1>
<p><em>Performance biomarkers</em> are nodes in our studied networks (boolean models) whose activity state and/or boolean model parameterization (link operator) affects the prediction performance of those models. These nodes can be thus used as <em>indicators</em> of either activity or structural changes that have a positive effect on the prediction performance of our models.</p>
<p>The model performance can be assessed via various ways. In this package we offer two ways to group the models to different classification categories: either based on the <strong>number of true positive (TP) predictions</strong> or on the <strong>Matthews correlation coefficient (MCC) score</strong> with respect to the drug combination dataset tested. The function <code><a href="../reference/biomarker_tp_analysis.html">emba::biomarker_tp_analysis()</a></code> is used for the former classification and the function <code><a href="../reference/biomarker_mcc_analysis.html">emba::biomarker_mcc_analysis()</a></code> for the latter. Note that it’s generally better to use the MCC classification, since it’s a more robust performance evalution metric compared to the TP predictions, since it takes into account all of the four confusion matrix values.</p>
<p>When the models have been grouped to different classification categories, their nodes activity or boolean model parameterization can be summarised in each group and compared to the others, obtaining thus the expected biomarkers using the methodology described below.</p>
<div id="tp-based-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#tp-based-analysis" class="anchor"></a>TP-based analysis</h2>
<p>We use the <code><a href="../reference/biomarker_tp_analysis.html">emba::biomarker_tp_analysis()</a></code> function with the specified inputs:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">tp.analysis.res</span> <span class="kw">=</span> <span class="kw pkg">emba</span><span class="kw ns">::</span><span class="fu"><a href="../reference/biomarker_tp_analysis.html">biomarker_tp_analysis</a></span>(
  <span class="no">model.predictions</span>,
  <span class="no">models.stable.state</span>,
  <span class="no">models.link.operator</span>,
  <span class="no">observed.synergies</span>,
  <span class="kw">penalty</span> <span class="kw">=</span> <span class="fl">0.1</span>,
  <span class="kw">threshold</span> <span class="kw">=</span> <span class="fl">0.55</span>)</pre></body></html></div>
<p>The <code>penalty</code> term is used to reduce the bias when model groups have different <em>sizes</em>. For example, if I were to compare the average activity of nodes between two groups of models, with respective group sizes 5 and 1000, then the result would be heavily biased towards the group with the larger size, making thus the quality of the results coming out of this comparison questionable. As such, with <code>penalty</code> values closer to 0, more bias is introduced and we expect more biomarkers to be found. See more info on <code><a href="../reference/get_vector_diff.html">emba::get_vector_diff()</a></code>.</p>
<p>Firstly, we get the predicted synergies - i.e. the drug combinations that are a subset of the observed ones and were <strong>predicted by at least one</strong> of the models in the dataset:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="kw pkg">usefun</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/usefun/man/pretty_print_vector_values.html">pretty_print_vector_values</a></span>(<span class="no">tp.analysis.res</span>$<span class="no">predicted.synergies</span>, <span class="kw">vector.values.str</span> <span class="kw">=</span> <span class="st">"predicted synergies"</span>)</pre></body></html></div>
<blockquote>
<p>5 predicted synergies: AK-PD, BI-PD, BI-PI, PD-PI, PI-D1</p>
</blockquote>
<p>The percentage of true positive predicted synergies is thus 29.4%. Such a low number might be a sign that the models quality is poor (need for a different parameterization) or other reasons like incorrect assessement of the gold standard synergies, etc.</p>
<p>The next informative barplot shows the distribution of models according to their true positive predictions:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu">pr</span>(<span class="kw pkg">emba</span><span class="kw ns">::</span><span class="fu"><a href="../reference/make_barplot_on_models_stats.html">make_barplot_on_models_stats</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">tp.analysis.res</span>$<span class="no">models.synergies.tp</span>),
  <span class="kw">title</span> <span class="kw">=</span> <span class="st">"True Positive Synergy Predictions"</span>,
  <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Number of maximum correctly predicted synergies"</span>,
  <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Number of models"</span>))</pre></body></html></div>
<p><img src="emba_files/figure-html/tp-analysis-3-1.png" width="672" style="display: block; margin: auto;"></p>
<ul>
<li>The <strong>maximum number of predicted synergies by any individual model</strong> is 3</li>
<li>There are only 2 models in total that could predict these 3 synergies</li>
<li>Almost half of the models make no true positive predictions</li>
</ul>
<p>Next result we get is the <strong>average activity differences</strong> per network node for all group classifications:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">tp.analysis.res</span>$<span class="no">diff.state.tp.mat</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"AKT"</span>,<span class="st">"PTEN"</span>,<span class="st">"PSEN1"</span>,<span class="st">"STAT3"</span>,<span class="st">"CEBPA"</span>)) <span class="kw">%&gt;%</span> <span class="co"># show only part of the matrix</span>
  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw">caption</span> <span class="kw">=</span> <span class="st">"Average Activity Difference Matrix"</span>)</pre></body></html></div>
<table class="table">
<caption>Average Activity Difference Matrix</caption>
<thead><tr class="header">
<th></th>
<th align="right">AKT</th>
<th align="right">PTEN</th>
<th align="right">PSEN1</th>
<th align="right">STAT3</th>
<th align="right">CEBPA</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>(0,1)</td>
<td align="right">-0.0278105</td>
<td align="right">0.4462906</td>
<td align="right">-0.0012761</td>
<td align="right">0.2316447</td>
<td align="right">0.0283239</td>
</tr>
<tr class="even">
<td>(0,2)</td>
<td align="right">-0.0851093</td>
<td align="right">0.3814671</td>
<td align="right">0.0104114</td>
<td align="right">0.0200058</td>
<td align="right">0.0118586</td>
</tr>
<tr class="odd">
<td>(0,3)</td>
<td align="right">0.0175886</td>
<td align="right">0.2594653</td>
<td align="right">0.4728458</td>
<td align="right">-0.3232749</td>
<td align="right">0.4327603</td>
</tr>
<tr class="even">
<td>(1,2)</td>
<td align="right">-0.0630977</td>
<td align="right">0.0363188</td>
<td align="right">0.0113038</td>
<td align="right">-0.1576796</td>
<td align="right">-0.0099449</td>
</tr>
<tr class="odd">
<td>(1,3)</td>
<td align="right">0.0306321</td>
<td align="right">0.0456991</td>
<td align="right">0.4695673</td>
<td align="right">-0.4304678</td>
<td align="right">0.4157744</td>
</tr>
<tr class="even">
<td>(2,3)</td>
<td align="right">0.0916724</td>
<td align="right">0.0305575</td>
<td align="right">0.6086029</td>
<td align="right">-0.4379904</td>
<td align="right">0.5551273</td>
</tr>
</tbody>
</table>
<ul>
<li>Rows represent the different classification group matchings, e.g. (1,2) means the models that predicted 1 TP synergy vs the models that predicted 2 TP synergies.</li>
<li>All values are in the [-1,1] interval. The more negative the activity difference value, the more <em>inhibited</em> is the node in the better performance models (e.g. <code>STAT3</code> node). The more positive the activity difference value, the more <em>active</em> is the node in the better performance models (e.g. <code>CEBPA</code> node).</li>
<li>Based on the given <code>threshold</code> level, a node is declared as an <strong>activity biomarker</strong> if it’s highest absolute value surpasses that threshold (see <code><a href="../reference/get_biomarkers.html">emba::get_biomarkers()</a></code> for more info).</li>
</ul>
<p>In our case, <code>threshold = 0.55</code> and thus <code>CEBPA</code> and <code>PSEN1</code> are returned as active biomarkers:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="kw pkg">usefun</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/usefun/man/pretty_print_vector_values.html">pretty_print_vector_values</a></span>(<span class="no">tp.analysis.res</span>$<span class="no">biomarkers.tp.active</span>,
  <span class="kw">vector.values.str</span> <span class="kw">=</span> <span class="st">"active biomarkers"</span>)</pre></body></html></div>
<blockquote>
<p>2 active biomarkers: PSEN1, CEBPA</p>
</blockquote>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="kw pkg">usefun</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/usefun/man/pretty_print_vector_values.html">pretty_print_vector_values</a></span>(<span class="no">tp.analysis.res</span>$<span class="no">biomarkers.tp.inhibited</span>,
  <span class="kw">vector.values.str</span> <span class="kw">=</span> <span class="st">"inhibited biomarkers"</span>)</pre></body></html></div>
<blockquote>
<p>0 inhibited biomarkers:</p>
</blockquote>
<p>With the models initial network as an <a href="https://igraph.org/r/">igraph</a> object (see <code><a href="../reference/construct_network.html">emba::construct_network()</a></code> on how to create such a <code>net</code> object), we can visualize every row of the above matrix as follows:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu">pr</span>(<span class="kw pkg">emba</span><span class="kw ns">::</span><span class="fu"><a href="../reference/plot_avg_state_diff_graph.html">plot_avg_state_diff_graph</a></span>(<span class="no">net</span>, <span class="no">tp.analysis.res</span>$<span class="no">diff.state.tp.mat</span>[<span class="st">"(2,3)"</span>,],
  <span class="kw">layout</span> <span class="kw">=</span> <span class="no">nice.layout</span>, <span class="kw">title</span> <span class="kw">=</span> <span class="st">"Bad models (2 TP) vs Good models (3 TP)"</span>))</pre></body></html></div>
<p><img src="emba_files/figure-html/tp-analysis-6-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Note that with less <code>penalty</code>, more bias would be introduced and thus more biomarkers would be found (even for a higher chosed <code>threshold</code>):</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">tp.analysis.res.biased</span> <span class="kw">=</span> <span class="kw pkg">emba</span><span class="kw ns">::</span><span class="fu"><a href="../reference/biomarker_tp_analysis.html">biomarker_tp_analysis</a></span>(
  <span class="no">model.predictions</span>,
  <span class="no">models.stable.state</span>,
  <span class="no">models.link.operator</span>,
  <span class="no">observed.synergies</span>,
  <span class="kw">penalty</span> <span class="kw">=</span> <span class="fl">0</span>,
  <span class="kw">threshold</span> <span class="kw">=</span> <span class="fl">0.7</span>)

<span class="kw pkg">usefun</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/usefun/man/pretty_print_vector_values.html">pretty_print_vector_values</a></span>(<span class="no">tp.analysis.res.biased</span>$<span class="no">biomarkers.tp.active</span>,
  <span class="kw">vector.values.str</span> <span class="kw">=</span> <span class="st">"active biomarkers"</span>)</pre></body></html></div>
<blockquote>
<p>13 active biomarkers: PSEN1, CEBPA, MAPK8IP1, MAPK9, JAK1, TYK2, JAK3, IFNGR2/INFGR1, IFNGR1, PTPN11, IFNGR2, IL2RB, IL10RA</p>
</blockquote>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="kw pkg">usefun</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/usefun/man/pretty_print_vector_values.html">pretty_print_vector_values</a></span>(<span class="no">tp.analysis.res.biased</span>$<span class="no">biomarkers.tp.inhibited</span>,
  <span class="kw">vector.values.str</span> <span class="kw">=</span> <span class="st">"inhibited biomarkers"</span>)</pre></body></html></div>
<blockquote>
<p>17 inhibited biomarkers: MAP3K7, MAP2K6, MAP2K3, NLK, IKBKG, STAT3, RXRA, SOCS3, TGFB1, HSPA1A, SALL4, ROCK1, TGFBR1, TRAF6, RHOA, PIK3R1, CASP9</p>
</blockquote>
<p>Lats result we get is the <strong>average link operator differences</strong> per network node (whose boolean equation had a link operator) for all group classifications:</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">tp.analysis.res</span>$<span class="no">diff.link.tp.mat</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"AKT"</span>,<span class="st">"PTEN"</span>,<span class="st">"PSEN1"</span>,<span class="st">"STAT3"</span>,<span class="st">"CEBPA"</span>)) <span class="kw">%&gt;%</span> <span class="co"># show only part of the matrix</span>
  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw">caption</span> <span class="kw">=</span> <span class="st">"Average Link Operator Difference Matrix"</span>)</pre></body></html></div>
<table class="table">
<caption>Average Link Operator Difference Matrix</caption>
<thead><tr class="header">
<th></th>
<th align="right">AKT</th>
<th align="right">PTEN</th>
<th align="right">PSEN1</th>
<th align="right">STAT3</th>
<th align="right">CEBPA</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>(0,1)</td>
<td align="right">0.2019689</td>
<td align="right">0.4291810</td>
<td align="right">-0.0047786</td>
<td align="right">0.2316447</td>
<td align="right">0.0269599</td>
</tr>
<tr class="even">
<td>(0,2)</td>
<td align="right">0.1116284</td>
<td align="right">0.3682466</td>
<td align="right">-0.1722642</td>
<td align="right">0.0200058</td>
<td align="right">0.0101784</td>
</tr>
<tr class="odd">
<td>(0,3)</td>
<td align="right">0.1588424</td>
<td align="right">0.2512846</td>
<td align="right">0.2915064</td>
<td align="right">-0.3232749</td>
<td align="right">0.4356235</td>
</tr>
<tr class="even">
<td>(1,2)</td>
<td align="right">-0.0440675</td>
<td align="right">0.0363188</td>
<td align="right">-0.1671873</td>
<td align="right">-0.1576796</td>
<td align="right">-0.0105660</td>
</tr>
<tr class="odd">
<td>(1,3)</td>
<td align="right">0.0617622</td>
<td align="right">0.0456991</td>
<td align="right">0.2913783</td>
<td align="right">-0.4304678</td>
<td align="right">0.4192610</td>
</tr>
<tr class="even">
<td>(2,3)</td>
<td align="right">0.1171370</td>
<td align="right">0.0305575</td>
<td align="right">0.5194769</td>
<td align="right">-0.4379904</td>
<td align="right">0.5602202</td>
</tr>
</tbody>
</table>
<ul>
<li>Rows again represent the different classification group matchings, e.g. (1,2) means the models that predicted 1 TP synergy vs the models that predicted 2 TP synergies.</li>
<li>All values are in the [-1,1] interval. A value closer to -1 means that on average, the node’s boolean equation has the <em>AND NOT</em> link operator in the better performance models (e.g. <code>STAT3</code> node). A value closer to 1 means that on average, the node’s boolean equation has mostly the <em>OR NOT</em> link operator in the better performance models (e.g. <code>CEBPA</code> node).</li>
<li>Based on the given <code>threshold</code> level, a node is declared as a <strong>link operator biomarker</strong> if it’s highest absolute value surpasses that threshold (see <code><a href="../reference/get_biomarkers.html">emba::get_biomarkers()</a></code> for more info).</li>
</ul>
<p>In our case, <code>threshold = 0.55</code> and thus <code>CEBPA</code> is returned as an <code>OR</code> link operator biomarker:</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="kw pkg">usefun</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/usefun/man/pretty_print_vector_values.html">pretty_print_vector_values</a></span>(<span class="no">tp.analysis.res</span>$<span class="no">biomarkers.tp.or</span>,
  <span class="kw">vector.values.str</span> <span class="kw">=</span> <span class="st">"'OR' biomarkers"</span>)</pre></body></html></div>
<blockquote>
<p>1 ‘OR’ biomarker: CEBPA</p>
</blockquote>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="kw pkg">usefun</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/usefun/man/pretty_print_vector_values.html">pretty_print_vector_values</a></span>(<span class="no">tp.analysis.res</span>$<span class="no">biomarkers.tp.and</span>,
  <span class="kw">vector.values.str</span> <span class="kw">=</span> <span class="st">"'AND' biomarkers"</span>)</pre></body></html></div>
<blockquote>
<p>0 ‘AND’ biomarkers:</p>
</blockquote>
<p>Interpreting the result regarding the <code>CEBPA</code> biomarker, we look back at its boolean equation and we see that the higher performance models must have the <code>OR NOT</code> link operator in order for <code>CEBPA</code> to be in an active (ON) state (an <code>AND NOT</code> results mostly on an inhibited state for <code>CEBPA</code>):</p>
<p><code>CEBPA = (GSK3B OR MAP2K1 OR MEK1/2) OR NOT CTNNB1</code></p>
</div>
<div id="mcc-based-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#mcc-based-analysis" class="anchor"></a>MCC-based analysis</h2>
</div>
</div>
<div id="synergy-biomarkers" class="section level1">
<h1 class="hasAnchor">
<a href="#synergy-biomarkers" class="anchor"></a>Synergy biomarkers</h1>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Note that the assessement of these synergies based on experimental data (usually High-Throughput Screening data) is an analysis on its own<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by John Zobolas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
