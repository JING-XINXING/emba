<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>emba • emba</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="emba">
<meta property="og:description" content="emba">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">emba</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/emba.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bblodfon/emba/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="emba_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>emba</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bblodfon/emba/blob/master/vignettes/emba.Rmd"><code>vignettes/emba.Rmd</code></a></small>
      <div class="hidden name"><code>emba.Rmd</code></div>

    </div>

    
    
<div id="intro" class="section level1">
<h1 class="hasAnchor">
<a href="#intro" class="anchor"></a>Intro</h1>
<p>The <em>emba</em> R package name stands for <em>Ensemble (Boolean) Model Biomarker Analysis</em>. It’s main purpose is to be used on a dataset consisted of an <strong>ensemble of boolean models</strong>. These models are usually (but not necessarily) different versions of the same initial model, parameterized in different ways (e.g. some boolean operators in the models equations have changed from <em>OR</em> to <em>AND</em> or vice-versa). A prerequisite for using this package, is that this model dataset must be tested in-silico against a list of drug combinations, in order to assess which drugs combinations behave <em>synergistically</em> for which models. An example software that generates such boolean model ensembles and performs a comprehensive drug response analysis on them is the DrugLogics NTNU software pipeline (see <a href="https://druglogics.github.io/druglogics-doc/">documentation</a>).</p>
<p>Given a list of lab-observed and verified <strong>synergies</strong> <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, this package enables the easy grouping of the models into different classes based on different performance metric evaluations. This group classification enables the discovery and visualization of <strong>biomarkers</strong> - nodes whose activity and/or boolean model parameterization might affect either the performance of those models or the manifestation of the predicted synergies.</p>
<p>In the next sections we will describe the main inputs and outputs of the <em>general analysis</em> functions (which group a lot of functionality into one) and provide some insights on the implementation behind. Biomarkers will be assessed and visualized using a test dataset generated from the DrugLogics software mentioned above. For further analyses using this package on boolean model ensemble datasets see this <a href="https://github.com/bblodfon/gitsbe-model-analysis/">GitHub repository</a>. See also <a href="https://bblodfon.github.io/gitsbe-model-analysis/atopo/cell-lines-2500/">an example</a> that demonstrates all the intermediate steps included in the <em>general analysis</em> functions.</p>
</div>
<div id="setup" class="section level1">
<h1 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h1>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="co"># libraries</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">emba</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">usefun</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)</pre></body></html></div>
</div>
<div id="input" class="section level1">
<h1 class="hasAnchor">
<a href="#input" class="anchor"></a>Input</h1>
<div id="test-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#test-dataset" class="anchor"></a>Test dataset</h2>
<p>The test dataset we will use has <span class="math inline">\(7500\)</span> boolean models with <span class="math inline">\(139\)</span> nodes each. It helps to think of each model as a <strong>network of nodes</strong> where the edges represent either activation or inhibition of the corresponding target and the nodes activity can be either active (1) or inactive (0). The models have been assessed for synergy against a total of <span class="math inline">\(153\)</span> drug combinations.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">data_file</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span>()
<span class="kw pkg">utils</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span>(<span class="kw">url</span> <span class="kw">=</span> <span class="st">"https://github.com/bblodfon/emba/blob/master/vignettes/data.rds?raw=true"</span>, <span class="kw">destfile</span> <span class="kw">=</span> <span class="no">data_file</span>)
<span class="no">data.list</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="kw">file</span> <span class="kw">=</span> <span class="no">data_file</span>)

<span class="no">model.predictions</span> <span class="kw">=</span> <span class="no">data.list</span>$<span class="no">model.predictions</span>
<span class="no">models.stable.state</span> <span class="kw">=</span> <span class="no">data.list</span>$<span class="no">models.stable.state</span>
<span class="no">models.link.operator</span> <span class="kw">=</span> <span class="no">data.list</span>$<span class="no">models.equations</span>
<span class="no">observed.synergies</span> <span class="kw">=</span> <span class="no">data.list</span>$<span class="no">observed.synergies</span>

<span class="co"># drug combinations</span>
<span class="no">drug.combos</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">model.predictions</span>)

<span class="co"># change model names (shorter names)</span>
<span class="no">model.names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"model"</span>, <span class="fl">1</span>:<span class="fl">7500</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">model.predictions</span>) <span class="kw">=</span> <span class="no">model.names</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">models.stable.state</span>) <span class="kw">=</span> <span class="no">model.names</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">models.link.operator</span>) <span class="kw">=</span> <span class="no">model.names</span></pre></body></html></div>
</div>
<div id="model-predictions" class="section level2">
<h2 class="hasAnchor">
<a href="#model-predictions" class="anchor"></a>Model Predictions</h2>
<p>The model predictions is a <code>data.frame</code> whose values (corresponding to a specific model-drug combination element) can be one of the following:</p>
<ul>
<li>0 (no synergy predicted)</li>
<li>1 (synergy was predicted)</li>
<li>
<code>NA</code> (in case the model couldn’t be assessed for synergy, e.g. there were no stable states in either the drug combination perturbed model or in any of the two single-drug perturbed models).</li>
</ul>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">model.predictions</span>[<span class="fl">1</span>:<span class="fl">5</span>, <span class="fl">77</span>:<span class="fl">84</span>] <span class="kw">%&gt;%</span> <span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw">caption</span> <span class="kw">=</span> <span class="st">"Model predictions example"</span>)</pre></body></html></div>
<table class="table">
<caption>Model predictions example</caption>
<thead><tr class="header">
<th></th>
<th align="right">PI-JN</th>
<th align="right">PI-D1</th>
<th align="right">PI-60</th>
<th align="right">PI-SB</th>
<th align="right">PI-RU</th>
<th align="right">PI-D4</th>
<th align="right">PI-F4</th>
<th align="right">PI-ST</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>model1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td>model2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td>model3</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td>model4</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td>model5</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="model-stable-states" class="section level2">
<h2 class="hasAnchor">
<a href="#model-stable-states" class="anchor"></a>Model stable states</h2>
<p>Each model must have a stable state configuration where all the nodes have stabilized to either 0 (inactive state) or 1 (active state). In other words, a <strong>fixpoint attractor</strong>. Of course, if a model has multiple attractors or other methods are used to derive a solution to the system of boolean equations that is the model itself, then continuous activity state values (in the <span class="math inline">\([0,1]\)</span> interval) are also supported.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">models.stable.state</span>[<span class="fl">1</span>:<span class="fl">5</span>, <span class="fl">5</span>:<span class="fl">11</span>] <span class="kw">%&gt;%</span> <span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw">caption</span> <span class="kw">=</span> <span class="st">"Stable activity states example"</span>)</pre></body></html></div>
<table class="table">
<caption>Stable activity states example</caption>
<thead><tr class="header">
<th></th>
<th align="right">MAP3K4</th>
<th align="right">MAP2K4</th>
<th align="right">IKBKG</th>
<th align="right">IKBKB</th>
<th align="right">AKT1</th>
<th align="right">BRAF</th>
<th align="right">SMAD3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>model1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>model2</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>model3</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>model4</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>model5</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<div id="model-link-operators" class="section level2">
<h2 class="hasAnchor">
<a href="#model-link-operators" class="anchor"></a>Model link operators</h2>
<p>This is a non-essential input for the general functions we will use, but we include it here since the test dataset supports it.</p>
<p>If each boolean model is a list of boolean equations of the form: <code>T = (A1 OR A2 OR ...) AND NOT (I1 OR I2 OR ...)</code>, where the <code>A</code> and <code>I</code> nodes are the activating and inhibiting regulators respectively of the target node <code>T</code> and the <code>AND NOT</code> is the <strong>link (balance) operator</strong>, we can specify a link operator <code>data.frame</code> object whose values (corresponding to a specific model-node element) can be one of the following:</p>
<ul>
<li>0 (<code>AND NOT</code> link operator)</li>
<li>1 (<code>OR NOT</code> link operator)</li>
<li>0.5 (if the node is not targeted by <em>both</em> activating and inhibiting regulators and thus the corresponding boolean equation has no link operator)</li>
</ul>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">models.link.operator</span>[<span class="fl">1</span>:<span class="fl">5</span>, <span class="fl">1</span>:<span class="fl">10</span>] <span class="kw">%&gt;%</span> <span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw">caption</span> <span class="kw">=</span> <span class="st">"Models link operator example"</span>)</pre></body></html></div>
<table class="table">
<caption>Models link operator example</caption>
<thead><tr class="header">
<th></th>
<th align="right">MAP3K4</th>
<th align="right">MAP2K4</th>
<th align="right">IKBKB</th>
<th align="right">AKT1</th>
<th align="right">SMAD3</th>
<th align="right">GSK3B</th>
<th align="right">RAF1</th>
<th align="right">GAB2</th>
<th align="right">CTNNB1</th>
<th align="right">NR3C1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>model1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>model2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>model3</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>model4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>model5</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>Note that in the test dataset, the nodes (columns of the <code>models.link.operator</code> object) who didn’t have a link operator are pruned.</p>
</div>
<div id="observed-synergies" class="section level2">
<h2 class="hasAnchor">
<a href="#observed-synergies" class="anchor"></a>Observed synergies</h2>
<p>A list of <em>gold standard</em> drug combinations which will have been termed as <strong>synergistic</strong> via experimental and/or other computational methods.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="kw pkg">usefun</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/usefun/man/pretty_print_vector_values.html">pretty_print_vector_values</a></span>(<span class="no">observed.synergies</span>, <span class="kw">vector.values.str</span> <span class="kw">=</span> <span class="st">"observed synergies"</span>)</pre></body></html></div>
<blockquote>
<p>17 observed synergies: AK-60, AK-BI, AK-D1, PI-D1, PD-G2, AK-G4, D1-G4, PI-JN, BI-P5, PD-P5, PI-P5, AK-PD, BI-PD, AK-PI, BI-PI, PD-PI, PK-ST</p>
</blockquote>
</div>
</div>
<div id="performance-biomarkers" class="section level1">
<h1 class="hasAnchor">
<a href="#performance-biomarkers" class="anchor"></a>Performance biomarkers</h1>
<div id="tp-based-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#tp-based-analysis" class="anchor"></a>TP-based analysis</h2>
</div>
<div id="mcc-based-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#mcc-based-analysis" class="anchor"></a>MCC-based analysis</h2>
</div>
</div>
<div id="synergy-biomarkers" class="section level1">
<h1 class="hasAnchor">
<a href="#synergy-biomarkers" class="anchor"></a>Synergy biomarkers</h1>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Note that the assessement of these synergies based on experimental data (usually High-Throughput Screening data) is an analysis on its own<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by John Zobolas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
